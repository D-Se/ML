<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Model performance | Machine Learning in R</title>
<meta name="author" content="Donald Seinen">
<meta name="description" content="Here is an example constructed from sample data, training 12 different ML models.  Which model performed the best?  library(ggplot2) targets::tar_read(ranking) +  theme_bw() A quick overview,...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Model performance | Machine Learning in R">
<meta property="og:type" content="book">
<meta property="og:description" content="Here is an example constructed from sample data, training 12 different ML models.  Which model performed the best?  library(ggplot2) targets::tar_read(ranking) +  theme_bw() A quick overview,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Model performance | Machine Learning in R">
<meta name="twitter:description" content="Here is an example constructed from sample data, training 12 different ML models.  Which model performed the best?  library(ggplot2) targets::tar_read(ranking) +  theme_bw() A quick overview,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><scrpt src="js/anchor.js"><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="assets/style.css"></scrpt>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Machine Learning in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> ML </a></li>
<li><a class="" href="overview.html"><span class="header-section-number">2</span> Overview</a></li>
<li><a class="active" href="model-performance.html"><span class="header-section-number">3</span> Model performance</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendix-a.html"><span class="header-section-number">A</span> Appendix A</a></li>
<li><a class="" href="author.html">About the Authors</a></li>
<li><a class="" href="report_a11c3970.html"><span class="header-section-number">B</span> report_a11c3970</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="model-performance" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Model performance<a class="anchor" aria-label="anchor" href="#model-performance"><i class="fas fa-link"></i></a>
</h1>
<p>Here is an example constructed from sample data, training 12 different ML models.</p>
<div class="question">
<center>
Which model performed the best?
</center>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html">tar_read</a></span><span class="op">(</span><span class="va">ranking</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="man/figures/README-unnamed-chunk-7-1.png" width="100%"></div>
<p>A quick overview, obtained from a node in the pipeline.</p>
<div class="note">
<center>
Always check the actual predictions to look for anomalies!
</center>
</div>
<p>And to check if the predictions are close to the actual observations, we inspect another node from the pipeline.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html">tar_read</a></span><span class="op">(</span><span class="va">visual_verify</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="man/figures/README-unnamed-chunk-8-1.png" width="100%"></div>
<p>Looks good. What is the error metric associated with this?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html">tar_read</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;"># A tibble: 2 x 4</span></span>
<span class="co">#&gt;   .metric .estimator .estimate .config             </span>
<span class="co">#&gt;   <span style="color: #555555; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #555555; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #555555; font-style: italic;">&lt;chr&gt;</span>               </span>
<span class="co">#&gt; <span style="color: #555555;">1</span> rmse    standard       3.72  Preprocessor1_Model1</span>
<span class="co">#&gt; <span style="color: #555555;">2</span> rsq     standard       0.949 Preprocessor1_Model1</span></code></pre></div>
<div class="question">
<center>
Looks neat! how do I get this model in my RStudio to test it? What are the model parameters?
</center>
</div>
<p>That is the benefit of making your own package.<br>
- Simply run <code><a href="https://rdrr.io/pkg/ML/man/results.html">ML::results</a></code> to get the best performing model straight into your R session
- Look at the documentation by running <code>?results</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ML</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ML/man/results.html">results</a></span>
<span class="co">#&gt; $predictions</span>
<span class="co">#&gt; <span style="color: #555555;"># A tibble: 249 x 3</span></span>
<span class="co">#&gt;    sample_row model_prediction actual_observation</span>
<span class="co">#&gt;         <span style="color: #555555; font-style: italic;">&lt;int&gt;</span>            <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #555555;"> 1</span>          3            18.9               17.3 </span>
<span class="co">#&gt; <span style="color: #555555;"> 2</span>          5             3.81               2.33</span>
<span class="co">#&gt; <span style="color: #555555;"> 3</span>          7            21.2               20.6 </span>
<span class="co">#&gt; <span style="color: #555555;"> 4</span>         14             9.21              10.4 </span>
<span class="co">#&gt; <span style="color: #555555;"> 5</span>         18            34.0               33.3 </span>
<span class="co">#&gt; <span style="color: #555555;"> 6</span>         22            35.9               36.6 </span>
<span class="co">#&gt; <span style="color: #555555;"> 7</span>         23            32.0               31.0 </span>
<span class="co">#&gt; <span style="color: #555555;"> 8</span>         24            31.2               28.9 </span>
<span class="co">#&gt; <span style="color: #555555;"> 9</span>         29            19.9               18.2 </span>
<span class="co">#&gt; <span style="color: #555555;">10</span>         30            37.1               29.1 </span>
<span class="co">#&gt; <span style="color: #555555;"># ... with 239 more rows</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $workflow</span>
<span class="co">#&gt; == Workflow [trained] ==========================================================</span>
<span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Variables</span>
<span class="co">#&gt; <span style="font-style: italic;">Model:</span> boost_tree()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- Preprocessor ----------------------------------------------------------------</span>
<span class="co">#&gt; Outcomes: compressive_strength</span>
<span class="co">#&gt; Predictors: everything()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- Model -----------------------------------------------------------------------</span>
<span class="co">#&gt; ##### xgb.Booster</span>
<span class="co">#&gt; Handle is invalid! Suggest using xgb.Booster.complete</span>
<span class="co">#&gt; raw: 3.4 Mb </span>
<span class="co">#&gt; call:</span>
<span class="co">#&gt;   xgboost::xgb.train(params = list(eta = 0.0441995347243183, max_depth = 13L, </span>
<span class="co">#&gt;     gamma = 7.77839129518202e-09, colsample_bytree = 1, colsample_bynode = 1, </span>
<span class="co">#&gt;     min_child_weight = 6L, subsample = 0.155629670358263, objective = "reg:squarederror"), </span>
<span class="co">#&gt;     data = x$data, nrounds = 1862L, watchlist = x$watchlist, </span>
<span class="co">#&gt;     verbose = 0, nthread = 1)</span>
<span class="co">#&gt; params (as set within xgb.train):</span>
<span class="co">#&gt;   eta = "0.0441995347243183", max_depth = "13", gamma = "7.77839129518202e-09", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "6", subsample = "0.155629670358263", objective = "reg:squarederror", nthread = "1", validate_parameters = "TRUE"</span>
<span class="co">#&gt; callbacks:</span>
<span class="co">#&gt;   cb.evaluation.log()</span>
<span class="co">#&gt; # of features: 8 </span>
<span class="co">#&gt; niter: 1862</span>
<span class="co">#&gt; nfeatures : 8 </span>
<span class="co">#&gt; evaluation_log:</span>
<span class="co">#&gt;     iter training_rmse</span>
<span class="co">#&gt;        1     36.682041</span>
<span class="co">#&gt;        2     35.311272</span>
<span class="co">#&gt; ---                   </span>
<span class="co">#&gt;     1861      1.508187</span>
<span class="co">#&gt;     1862      1.508148</span></code></pre></div>

</div>



  <div class="chapter-nav">
<div class="prev"><a href="overview.html"><span class="header-section-number">2</span> Overview</a></div>
<div class="next"><a href="appendix-a.html"><span class="header-section-number">A</span> Appendix A</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#model-performance"><span class="header-section-number">3</span> Model performance</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Machine Learning in R</strong>" was written by Donald Seinen. It was last built on 2022-02-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
